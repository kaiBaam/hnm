<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>H&W Author Portfolio</title>
  <link rel="stylesheet" href="style3.css">
</head>
<body style="overflow-x: hidden;">

<!-- HEADER PLACEHOLDER -->
<div id="header-placeholder"></div>

<script>
fetch('header.html')
  .then(response => response.text())
  .then(data => {
    document.getElementById('header-placeholder').innerHTML = data;
    const script = document.createElement('script');
    script.src = 'script.js';
    document.body.appendChild(script);
  });
</script>

<!-- MAIN CONTENT -->
<section class="latest-reviews">
  <div class="left-image">
    <a id="imageLink" href="#">
      <img id="mainImage" src="image1.jpg" alt="Main Image">
    </a>
  </div>
  <div class="right-titles">
    <ul>
      <li data-image="image1.jpg" data-link="article1.html"><a href="#">Post Title 1</a></li>
      <li data-image="image2.jpg" data-link="article2.html"><a href="#">Post Title 2</a></li>
      <li data-image="image3.jpg" data-link="article3.html"><a href="#">Post Title 3</a></li>
      <li data-image="image4.jpg" data-link="article4.html"><a href="#">Post Title 4</a></li>
      <li data-image="image5.jpg" data-link="article5.html"><a href="#">Post Title 5</a></li>
    </ul>
  </div>
</section>

<section id="blogposts">
  <div class="blog-grid">
    <h2>Latest on the Blog</h2>
    <div class="posts-grid" id="postsGrid"></div>
  </div>
</section>

<script>
fetch('http://localhost:1337/api/posts?populate=*')
  .then(response => response.json())
  .then(data => {
    const posts = data.data;
    const postsGrid = document.getElementById('postsGrid');

    posts.forEach(post => {
      const attributes = post.attributes;
      const title = attributes.Title || "Untitled";
      const body = attributes.Body || "";
      const date = attributes.Date || "";
      const genre = attributes.Genre || "Review";

      let imageUrl = "";
      if (attributes.Poster?.data?.attributes?.url) {
        imageUrl = attributes.Poster.data.attributes.url;
        if (imageUrl.startsWith('/')) {
          imageUrl = `http://localhost:1337${imageUrl}`;
        }
      }

      const article = document.createElement('article');
      article.className = 'tease-post';
      article.innerHTML = `
        <div class="post-meta">
          <time datetime="${date}">${date}</time>
          <span class="post-tag">${genre}</span>
        </div>
        <div class="post-content">
          <h3><a href="#">${title}</a></h3>
          <p>${body.substring(0, 100)}...</p>
        </div>
        <hr>
      `;
      postsGrid.appendChild(article);
    });
  })
  .catch(err => console.error('Error loading posts:', err));
</script>

<!-- FOOTER -->
<div id="footer-placeholder"></div>

<script>
fetch('footer.html')
  .then(response => response.text())
  .then(data => {
    document.getElementById('footer-placeholder').innerHTML = data;
  });
</script>

</body>
</html>
